<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>뉴스퀘어 메인</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/main.css" />
</head>
<body>
<header>
  <div th:replace="~{fragments/header :: header}"></div>
</header>

<div class="sidebar">
    <div class="box">
        <strong>실시간 인기 검색어</strong><br />
        · 시사저널<br />
        · 오마이뉴스<br />
        · 연합뉴스...
    </div>
    <div class="box">
        <strong>언론사별 바로가기</strong><br />
        <a href="/news/list?mediaCompany=DONGA" class="no-underline">· 동아일보</a><br />
        <a href="/news/list?mediaCompany=YTN" class="no-underline">· YTN</a><br />
        <a href="/news/list?mediaCompany=HANI" class="no-underline">· 한겨레</a><br />
        <a href="/news/list?mediaCompany=JOONGANG" class="no-underline">· 중앙일보</a><br />
        <a href="/news/list?mediaCompany=KYUNGHYANG" class="no-underline">· 경향신문</a><br />
    </div>
    <div class="box">
        <strong>최근 수집된 기사</strong><br />
        <ul style="list-style: none; padding: 0; margin: 0;">
            <li th:each="news : ${recentNews}" style="margin-bottom: 6px;">
                · <span th:text="${news.category.displayName}">카테고리</span>:<br />
                <a th:href="@{'/news/list'(category=${news.category},mediaCompany=${news.mediaCompany},url=${news.url})}"
                   style="display: inline-block; font-size: 12px; color: #333; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;"
                   th:text="${#strings.abbreviate(news.title, 30)}"></a>
            </li>
        </ul>
    </div>
</div>

<div class="banner">
    <h1>핫이슈 기사와 정보를 한눈에 확인하세요.</h1>

    <div class="search-box">
        <input type="text" name="query" placeholder="기본 검색어를 입력해주세요" />
        <button onclick="search()">검색</button>
    </div>
</div>

<div class="filter-tabs">
    <ul>
        <li class="active">이슈별</li>
        <li>언론사별</li>
    </ul>
</div>

<div class="news-section">
    <div class="category-row">
        <!-- Map<NewsCategory, List<News>> newsByCategory 기준 반복 -->
        <div class="category-block" th:each="entry : ${newsByCategory}">
            <h3 class="category-title" th:text="${entry.key.displayName}">카테고리명</h3>

            <div class="news-grid">
                <div class="news-card" th:each="news : ${entry.value}"
                     th:data-category="${news.category}"
                     th:data-media="${news.mediaCompany}"
                     th:data-url="${news.url}">

                    <!-- 이미지 URL, 없으면 기본 이미지 -->
                    <img th:src="@{${news.imageUrl}}" onerror="this.src='/img/default.png'" alt="뉴스 이미지" />
                    <!-- 카드 내용 -->
                    <div class="news-card-content">
                        <h4 th:text="${news.title}">뉴스 제목</h4>
                            <p th:text="${#strings.abbreviate(news.content, 80)}">내용 요약</p>
                        <div class="news-meta" th:text="${#temporals.format(news.publishDate, 'yyyy.MM.dd')} + ' | ' + ${news.mediaCompany}">날짜 | 언론사</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="company-tab" class="tab-content" style="display: none;">
    <div class="news-section">
        <div class="category-row">
            <div class="category-block" th:each="entry : ${newsByCompany}">
                <h3 class="category-title" th:text="${entry.key.displayName}">언론사</h3>
                <div class="news-grid">
                    <div class="news-card" th:each="news : ${entry.value}"
                         th:data-category="${news.category}"
                         th:data-media="${news.mediaCompany}"
                         th:data-url="${news.url}">

                        <!-- 이미지 URL, 없으면 기본 이미지 -->
                        <img th:src="${#strings.isEmpty(news.imageUrl) ? '/img/default.png' : news.imageUrl}"
                             th:onerror="|this.onerror=null;this.src='@{/img/default.png}'|"
                             alt="뉴스 이미지" />

                        <!-- 카드 내용 -->
                        <div class="news-card-content">
                            <h4 th:text="${news.title}">뉴스 제목</h4>
                            <p th:text="${#strings.abbreviate(news.content, 80)}">내용 요약</p>
                            <div class="news-meta"
                                 th:text="${#temporals.format(news.publishDate, 'yyyy.MM.dd')} + ' | ' + ${news.mediaCompany}">
                                날짜 | 언론사
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="/js/main.js"></script>
</body>
</html>