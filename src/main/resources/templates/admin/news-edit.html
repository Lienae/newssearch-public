<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>관리자 - 뉴스 수정</title>
  <link rel="stylesheet" href="/css/style.css" />
  <link rel="stylesheet" href="/css/border-write.css" />
</head>
<body>
<div class="navbar">
  <a href="/main" class="logo">
    <img src="/img/NewsHub.png" alt="News Hub 로고" />
  </a>
  <nav>
    <a href="/news/list">뉴스</a>
    <a href="/boarder/list">커뮤니티</a>
  </nav>
  <div class="auth">
    <a href="/user/login">로그인</a>
    <a href="/user/register">회원가입</a>
  </div>
</div>

<div class="write-container">
  <h2>뉴스 수정</h2>
  <p class="info-text">관리자는 뉴스 기사를 수정할 수 있습니다.</p>

  <form class="post-form"
        th:action="@{'/admin/news/edit/' + ${news.id} + '?page=' + ${page} + '&size=' + ${size} + '&category=' + ${currentCategory} + '&mediaCompany=' + ${currentMediaCompany}}"
        method="post">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
    <input type="hidden" name="page" th:value="${page}" />
    <input type="hidden" name="size" th:value="${size}" />
    <input type="hidden" name="category" th:value="${currentCategory}" />

    <div class="form-group">
      <label for="id">ID</label>
      <input type="text" id="id" name="id" th:value="${news.id}" readonly class="readonly-input"/>
    </div>

    <div class="form-group">
      <label for="title">제목</label>
      <input type="text" id="title" name="title" placeholder="제목을 입력하세요." th:value="${news.title}" />
    </div>

    <div class="form-group">
      <label for="author">기자명</label>
      <input type="text" id="author" name="author" th:value="${news.author}"/>
    </div>

    <div class="form-group">
      <label for="category">카테고리</label>
      <select id="category" name="category" disabled>
        <option th:each="c : ${T(com.tjeoun.newssearch.enums.NewsCategory).values()}"
                th:value="${c.name()}"
                th:selected="${news.category.name() == c.name()}"
                th:text="${c.name()}"></option>

      </select>
    </div>

    <div class="form-group">
      <label for="media_company">언론사</label>
      <select id="media_company" name="mediaCompany" disabled>
        <option th:each="m : ${T(com.tjeoun.newssearch.enums.NewsMediaCompany).values()}"
                th:value="${m.name()}"
                th:selected="${news.mediaCompany.name() == m.name()}"
                th:text="${m.name()}"></option>
      </select>
    </div>

    <div class="form-group">
      <label for="content">내용</label>
      <textarea id="content" name="content" rows="10" placeholder="내용을 입력하세요." th:text="${news.content}"></textarea>
    </div>

    <div class="form-group">
      <label for="image_url">이미지 URL</label>
      <input type="text" id="image_url" name="imageUrl" placeholder="이미지 URL" th:value="${news.imageUrl}" />
    </div>

    <div class="form-group">
      <label for="url">원문 URL</label>
      <input type="text" id="url" name="url" placeholder="원문 링크를 입력하세요." th:value="${news.url}" readonly class="readonly-input" />
    </div>

    <div class="form-group">
      <label for="publishDate">발행일</label>
      <input type="text" id="publishDate" th:value="${#temporals.format(news.publishDate, 'yyyy-MM-dd HH:mm:ss')}" readonly class="readonly-input"/>
    </div>

    <div class="form-actions">
      <button type="button"
              class="cancel-btn"
              th:attr="data-url=@{/admin/news/list(page=${page}, size=${size}, category=${currentCategory}, mediaCompany=${currentMediaCompany})}"
              onclick="location.href = this.dataset.url">
        취소
      </button>

      <button type="submit" class="submit-btn">수정</button>
      <button type="button" class="delete-btn" onclick="submitDeleteForm()">삭제</button>
    </div>
  </form>
  <!-- 삭제 form -->
  <form id="deleteForm" th:action="@{'/admin/news/delete/' + ${news.id}}" method="post" style="display: none;">
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
  </form>
</div>
<script>
  function submitDeleteForm() {
    if (confirm('정말로 이 게시글을 삭제하시겠습니까?')) {
      document.getElementById('deleteForm').submit();
    }
  }
</script>
</body>
</html>
